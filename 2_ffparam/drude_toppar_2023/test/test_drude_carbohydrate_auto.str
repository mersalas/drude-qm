* $Id: test_drude_carbohydrate.str 28 2015-07-29 23:54:15Z alex $
* Test case, Drude carbohydrate toppar file
*

set boml 0 ! set to -1 if the series contains 3-membered rings

set nres 161

!polyols
set resi1 egly 
set seed1 1 O1 1 C1 1 C2
set resi2 mglyol 
set seed2 1 C1 1 C2 1 C3
set resi3 meryol
set seed3 1 C1 1 C2 1 C3
set resi4 dthrol
set seed4 1 C1 1 C2 1 C3
set resi5 lthrol
set seed5 1 C1 1 C2 1 C3
set resi6 mribol
set seed6 1 C1 1 C2 1 C3
set resi7 daraol
set seed7 1 C1 1 C2 1 C3
set resi8 laraol
set seed8 1 C1 1 C2 1 C3
set resi9 mxylol
set seed9 1 C1 1 C2 1 C3
set resi10 mallol 
set seed10 1 C1 1 C2 1 C3
set resi11 daltol
set seed11 1 C1 1 C2 1 C3
set resi12 laltol
set seed12 1 C1 1 C2 1 C3
set resi13 dgluol 
set seed13 1 C1 1 C2 1 C3
set resi14 lgluol
set seed14 1 C1 1 C2 1 C3
set seed15 1 C1 1 C2 1 C3
set resi15 dmanol
set seed15 1 C1 1 C2 1 C3
set resi16 lmanol
set seed16 1 C1 1 C2 1 C3
set resi17 dgulol 
set seed17 1 C1 1 C2 1 C3
set resi18 lgulol
set seed18 1 C1 1 C2 1 C3
set resi19 didiol 
set seed19 1 C1 1 C2 1 C3
set resi20 lidiol
set seed20 1 C1 1 C2 1 C3
set resi21 mgalol
set seed21 1 C1 1 C2 1 C3
!hexapyranoses
set resi22 aglc
set seed22 1 O5 1 C1 1 C2
set resi23 bglc
set seed23 1 O5 1 C1 1 C2
set resi24 aalt
set seed24 1 O5 1 C1 1 C2
set resi25 balt
set seed25 1 O5 1 C1 1 C2
set resi26 aall
set seed26 1 O5 1 C1 1 C2
set resi27 ball
set seed27 1 O5 1 C1 1 C2
set resi28 agal
set seed28 1 O5 1 C1 1 C2
set resi29 bgal
set seed29 1 O5 1 C1 1 C2
set resi30 agul
set seed30 1 O5 1 C1 1 C2
set resi31 bgul
set seed31 1 O5 1 C1 1 C2
set resi32 aido
set seed32 1 O5 1 C1 1 C2
set resi33 bido
set seed33 1 O5 1 C1 1 C2
set resi34 aman
set seed34 1 O5 1 C1 1 C2
set resi35 bman
set seed35 1 O5 1 C1 1 C2
set resi36 atal
set seed36 1 O5 1 C1 1 C2
set resi37 btal
set seed37 1 O5 1 C1 1 C2
!furanoses
set resi38 ARIB
set seed38 1 C4 1 O4 1 C1
set resi39 BRIB
set seed39 1 C4 1 O4 1 C1
set resi40 AARB
set seed40 1 C4 1 O4 1 C1
set resi41 BARB
set seed41 1 C4 1 O4 1 C1
set resi42 AXYF
set seed42 1 C4 1 O4 1 C1
set resi43 BXYF
set seed43 1 C4 1 O4 1 C1
set resi44 ALYF
set seed44 1 C4 1 O4 1 C1
set resi45 BLYF
set seed45 1 C4 1 O4 1 C1
set resi46 ADEO
set seed46 1 C4 1 O4 1 C1
set resi47 BDEO
set seed47 1 C4 1 O4 1 C1
set resi48 ALLO
set seed48 1 C1 1 C2 1 C3
set resi49 PSIC
set seed49 1 C1 1 C2 1 C3
set resi50 AFRU
set seed50 1 C5 1 O5 1 C2
set resi51 BFRU
set seed51 1 C5 1 O5 1 C2
!derivatives
set resi52  AGLCA
set seed52   1 O5 1 C1 1 C2
set resi53  BGLCA
set seed53   1 O5 1 C1 1 C2
set resi54  AGALA
set seed54   1 O5 1 C1 1 C2
set resi55  BGALA
set seed55   1 O5 1 C1 1 C2
set resi56  AIDOA
set seed56   1 O5 1 C1 1 C2
set resi57  BIDOA
set seed57   1 O5 1 C1 1 C2
set resi58  AGLCNA
set seed58   1 O5 1 C1 1 C2
set resi59  BGLCNA
set seed59   1 O5 1 C1 1 C2
set resi60  AGALNA
set seed60   1 O5 1 C1 1 C2
set resi61  BGALNA
set seed61   1 O5 1 C1 1 C2
set resi62  AMANNA
set seed62   1 O5 1 C1 1 C2
set resi63  BMANNA
set seed63   1 O5 1 C1 1 C2
! "minor modified and validated with QM" ahaile
set resi64  AXYL
set seed64   1 O5 1 C1 1 C2
set resi65  BXYL
set seed65   1 O5 1 C1 1 C2
set resi66  AFUC
set seed66   1 O5 1 C1 1 C2
set resi67  BFUC
set seed67   1 O5 1 C1 1 C2
set resi68  ARHM
set seed68   1 O5 1 C1 1 C2
set resi69  BRHM
set seed69   1 O5 1 C1 1 C2
set resi70  AQUI
set seed70   1 C4 1 C5 1 C6
set resi71  BQUI
set seed71   1 C4 1 C5 1 C6
set resi72  ARHMNA
set seed72   1 O5 1 C1 1 C2
set resi73  BRHMNA
set seed73   1 O5 1 C1 1 C2
set resi74  ANE5AC
set seed74   1 C3 1 C2 1 C1
set resi74  ANE5AC
set seed74   1 C3 1 C2 1 C1
! disac carbohydrate
set resi175 AARB
set resi275 AGLC
set patch75 PA11AA
set seed75 1 C4 1 O4 1 C1
set resi176 BARB
set resi276 AGLC
set patch76 PA11AB
set seed76 1 C4 1 O4 1 C1
set resi177 AARB
set resi277 BGLC
set patch77 PA11BA
set seed77 1 C4 1 O4 1 C1
set resi178 BARB
set resi278 BGLC
set patch78 PA11BB
set seed78 1 C4 1 O4 1 C1
set resi179 ARIB
set resi279 AGLC
set patch79 PA12AA
set seed79 1 C4 1 O4 1 C1
set resi180 AARB
set resi280 AGLC
set patch80 PA12AB
set seed80 1 C4 1 O4 1 C1
set resi181 BRIB
set resi281 BGLC
set patch81 PA12BA
set seed81 1 C4 1 O4 1 C1
set resi182 BARB
set resi282 BGLC
set patch82 PA12BB
set seed82 1 C4 1 O4 1 C1
set resi183 AARB
set resi283 AGLC
set patch83 PA13AA
set seed83 1 C4 1 O4 1 C1
set resi184 ALYF
set resi284 AGLC
set patch84 PA13AB
set seed84 1 C4 1 O4 1 C1
set resi185 AARB
set resi285 BGLC
set patch85 PA13BA
set seed85 1 C4 1 O4 1 C1
set resi186 BLYF
set resi286 BGLC
set patch86 PA13BB
set seed86 1 C4 1 O4 1 C1
set resi187 AARB
set resi287 AGLC
set patch87 PA15AB
set seed87 1 C4 1 O4 1 C1
set resi188 AARB
set resi288 BGLC
set patch88 PA15BB
set seed88 1 C4 1 O4 1 C1
set resi189 AARB
set resi289 AARB
set patch89 AA15AB
set seed89 1 C4 1 O4 1 C1
set resi190 AARB
set resi290 BARB
set patch90 AA15BB
set seed90 1 C4 1 O4 1 C1
set resi191 AGLC
set resi291 AGLC
set patch91 11AA
set seed91 1 O5 1 C1 1 C2
set resi192 AGLC
set resi292 BGLC
set patch92 11AB
set seed92 1 O5 1 C1 1 C2
set resi193 BGLC
set resi293 BGLC
set patch93 11BB
set seed93 1 O5 1 C1 1 C2
set resi194 AMAN
set resi294 AMAN
set patch94 12AA
set seed94 1 O5 1 C1 1 C2
set resi195 BGAL
set resi295 AGAL
set patch95 12AB
set seed95 1 O5 1 C1 1 C2
set resi196 AMAN
set resi296 BMAN
set patch96 12BA
set seed96 1 O5 1 C1 1 C2
set resi197 BGLC
set resi297 BGLC
set patch97 12BB
set seed97 1 O5 1 C1 1 C2
set resi198 AGUL
set resi298 AGUL
set patch98 13AA
set seed98 1 O5 1 C1 1 C2
set resi199 BMAN
set resi299 AMAN
set patch99 13AB
set seed99 1 O5 1 C1 1 C2
set resi1100 AGUL
set resi2100 BGUL
set patch100 13BA
set seed100 1 O5 1 C1 1 C2
set resi1101 BGAL
set resi2101 BGAL
set patch101 13BB
set seed101 1 O5 1 C1 1 C2
set resi1102 BGAL
set resi2102 AGAL
set patch102 14AA
set seed102 1 O5 1 C1 1 C2
set resi1103 AGLC
set resi2103 AGLC
set patch103 14AB
set seed103 1 O5 1 C1 1 C2
set resi1104 BGAL
set resi2104 BGAL
set patch104 14BA
set seed104 1 O5 1 C1 1 C2
set resi1105 BGLC
set resi2105 BGLC
set patch105 14BB
set seed105 1 O5 1 C1 1 C2
set resi1106 AGLC
set resi2106 AGLC
set patch106 16AB
set seed106 1 O5 1 C1 1 C2
set resi1107 AGLC
set resi2107 BGLC
set patch107 16BB
set seed107 1 O5 1 C1 1 C2
set resi1108 AFRU
set resi2108 AGLC
set patch108 16AB
set seed108 1 C5 1 O5 1 C2
set resi1109 BFRU
set resi2109 BGLC
set patch109 16BB
set seed109 1 C5 1 O5 1 C2
set resi1110 AFRU
set resi2110 AFRU
set patch110 FF26AB
set seed110 1 C5 1 O5 1 C2
set resi1111 AFRU
set resi2111 BFRU
set patch111 FF26BB
set seed111 1 C5 1 O5 1 C2
set resi1112 AFRU
set resi2112 AFRU
set patch112 FF21AB
set seed112 1 C5 1 O5 1 C2
set resi1113 AFRU
set resi2113 BFRU
set patch113 FF21AB
set seed113 1 C5 1 O5 1 C2
set resi1114 BFRU
set resi2114 AFRU
set patch114 FF21BB
set seed114 1 C5 1 O5 1 C2
set resi1115 BFRU
set resi2115 BFRU
set patch115 FF21BB
set seed115 1 C5 1 O5 1 C2
set resi1116 BFRU
set resi2116 AGLC
set patch116 PF13AB
set seed116 1 C5 1 O5 1 C2
set resi1117 BFRU
set resi2117 BGAL
set patch117 PF14BA
set seed117 1 C5 1 O5 1 C2
set resi1118 AGLC
set resi2118 AARB
set patch118 AP12AA
set seed118 1 O5 1 C1 1 C2
set resi1119 AMAN
set resi2119 AARB
set patch119 AP12AB
set seed119 1 O5 1 C1 1 C2
set resi1120 AGLC
set resi2120 BARB
set patch120 AP12BA
set seed120 1 O5 1 C1 1 C2
set resi1121 BMAN
set resi2121 BARB
set patch121 AP12BB
set seed121 1 O5 1 C1 1 C2
set resi1122 AGUL
set resi2122 AARB
set patch122 AP13AA
set seed122 1 O5 1 C1 1 C2
set resi1123 AMAN
set resi2123 AARB
set patch123 AP13AB
set seed123 1 O5 1 C1 1 C2
set resi1124 AGUL
set resi2124 BARB
set patch124 AP13BA
set seed124 1 O5 1 C1 1 C2
set resi1125 BMAN
set resi2125 BARB
set patch125 AP13BB
set seed125 1 O5 1 C1 1 C2
set resi1126 AGAL
set resi2126 AARB
set patch126 AP14AA
set seed126 1 O5 1 C1 1 C2
set resi1127 AGLC
set resi2127 AARB
set patch127 AP14AB
set seed127 1 O5 1 C1 1 C2
set resi1128 AGAL
set resi2128 BARB
set patch128 AP14BA
set seed128 1 O5 1 C1 1 C2
set resi1129 BGLC
set resi2129 BARB
set patch129 AP14BB
set seed129 1 O5 1 C1 1 C2
set resi1130 BGLC
set resi2130 AARB
set patch130 AP12AA
set seed130 1 O5 1 C1 1 C2
set resi1131 BMAN
set resi2131 AARB
set patch131 AP12AB
set seed131 1 O5 1 C1 1 C2
set resi1132 BGLC
set resi2132 BARB
set patch132 AP12BA
set seed132 1 O5 1 C1 1 C2
set resi1133 AMAN
set resi2133 BARB
set patch133 AP12BB
set seed133 1 O5 1 C1 1 C2
set resi1134 BGUL
set resi2134 AARB
set patch134 AP13AA
set seed134 1 O5 1 C1 1 C2
set resi1135 BMAN
set resi2135 AARB
set patch135 AP13AB
set seed135 1 O5 1 C1 1 C2
set resi1136 BGUL
set resi2136 BARB
set patch136 AP13BA
set seed136 1 O5 1 C1 1 C2
set resi1137 AMAN
set resi2137 BARB
set patch137 AP13BB
set seed137 1 O5 1 C1 1 C2
set resi1138 BGAL
set resi2138 AARB
set patch138 AP14AA
set seed138 1 O5 1 C1 1 C2
set resi1139 BGLC
set resi2139 AARB
set patch139 AP14AB
set seed139 1 O5 1 C1 1 C2
set resi1140 BGAL
set resi2140 BARB
set patch140 AP14BA
set seed140 1 O5 1 C1 1 C2
set resi1141 AGLC
set resi2141 BARB
set patch141 AP14BB
set seed141 1 O5 1 C1 1 C2
! glycosidic linkage patch  based on derivative 
set resi1141 AGLCNA
set resi2141 AGLC
set patch141 11AA
set seed141 1 O5 1 C1 1 C2
set resi1142 AGLCA
set resi2142 BGLC
set patch142 11AB
set seed142 1 O5 1 C1 1 C2
set resi1143 BGALA
set resi2143 AGAL
set patch143 12AB
set seed143 1 O5 1 C1 1 C2
set resi1144 BGLCA
set resi2144 BGLC
set patch144 12BB
set seed144 1 O5 1 C1 1 C2
set resi1145 BMANNA
set resi2145 AMAN
set patch145 13AB
set seed145 1 O5 1 C1 1 C2
set resi1146 BGALA
set resi2146 BGAL
set patch146 13BB
set seed146 1 O5 1 C1 1 C2
set resi1147 BGALNA
set resi2147 AGAL
set patch147 14AA
set seed147 1 O5 1 C1 1 C2
set resi1148 AGLCA
set resi2148 AGLC
set patch148 14AB
set seed148 1 O5 1 C1 1 C2
set resi1149 AGLCNA
set resi2149 AGLC
set patch149 16AB
set seed149 1 O5 1 C1 1 C2
! O-linkage glycoprotein patch
set resi1150 SER
set resi2150 AGLC
set patch150 SGPA
set  seed150 1 c  1 ca  1 cb
set resi1151 SER
set resi2151 AGLCNA
set patch151 SGPA
set  seed151 1 c  1 ca  1 cb
set resi1152 SER
set resi2152 BGLC
set patch152 SGPB
set  seed152 1 c  1 ca  1 cb
set resi1153 SER
set resi2153 BGLCNA
set patch153 SGPB
set  seed153 1 c  1 ca  1 cb
set resi1154 THR
set resi2154 AGLC
set patch154 TGPA
set  seed154 1 c  1 ca  1 cb
set resi1155 THR
set resi2155 AGLCNA
set patch155 TGPA
set  seed155 1 c  1 ca  1 cb
set resi1156 THR
set resi2156 BGLC
set patch156 TGPB
set  seed156 1 c  1 ca  1 cb
set resi1157 THR
set resi2157 BGLCNA
set patch157 TGPB
set  seed157 1 c  1 ca  1 cb
! N-linkage glycoprotein patch
set resi1158 ASN
set resi2158 AGLC
set patch158 NGLA
set  seed158 1 c  1 ca  1 cb
set resi1159 ASN
set resi2159 AGLCNA
set patch159 NGLA
set  seed159 1 c  1 ca  1 cb
set resi1160 ASN
set resi2160 BGLC
set patch160 NGLB
set  seed160 1 c  1 ca  1 cb
set resi1161 ASN
set resi2161 BGLCNA
set patch161 NGLB
set  seed161 1 c  1 ca  1 cb


set count 1
label loop_carb1

if @count .le. 74 then
set residue @resi@@count
read sequence @residue 1

bomlev @boml
generate @residue first none last none setup warn drude dmass 0.4 !show
bomlev 0

else
if @count .le. 149 then
read sequ card
*
2
@resi1@@count @resi2@@count
generate disa first none last none setup warn drude dmass 0.4 !show
patch @patch@@count disa 1 disa 2 setup warn drude dmass 0.4
bomlev 0

else

read sequence card
*
1
@resi1@@count
generate PROA first ace last ct3 setup warn drude dmass 0.4
read sequ card
*
1
@resi2@@count
generate disa  first none last none setup warn drude dmass 0.4
join proa disa renumber
patch @patch@@count PROA 1 proa 2 setup warn 
bomlev 0
endif
endif

ic param
ic seed @seed@@count
ic build 
coor sdrude
coor shake

! instead of relaxing Drude, move all Drude a little bit away from their parent atom
coor trans xdir -0.002 ydir -0.002 zdir -0.002 sele type D* end

update inbfrq -1 ihbfrq 0 switch atom vatom vswitch cutnb 999.0 ctofnb 997.0 ctonnb 995.0

if @mindr eq 0 then
  energy
 else
  cons harm force 100000. sele .not. type D* end
  mini ABNR nstep 200 nprint 20
  cons harm clear
 endif

 if @count .le. 74 then 
echo @residue starting E: ?ener
else
echo @resi1@@count-@resi2@@count-@patch@@count starting  E:  ?ener
!write coor pdb name tmp/@resi1@@count-@resi2@@count-@patch@@count_start.pdb
endif
if @?pdbdir eq 1 then
  write psf card name @pdbdir/@residue.psf
  write coor pdb name @pdbdir/@residue_start.pdb
 endif

if @mini ne 0 then
  mini sd nstep 1000 tolgrd 0.0001 nprint 100
  if ?grms gt 0.0001 mini abnr nstep 1000 tolgrd 0.0001
  if ?grms gt 0.0001 then
    echo FATAL ERROR: MINIMIZATION NOT CONVERGED
    echu
    echo FATAL ERROR: MINIMIZATION NOT CONVERGED
    stop
   endif
  if @count .le. 74 then 
    echo @residue minimized E: ?ener
  else
    echo @resi1@@count-@resi2@@count-@patch@@count minimized  E:  ?ener
  endif  
  if @?pdbdir eq 1 then ! cannot use 1-line syntax because substitution will fail
    write coor pdb name @pdbdir/@residue_min.pdb
   endif
 endif

coor orient
coor dipole oxyz select all end 
if @count .le. 74 then
echo @residue dipole: ?rdip
else
echo @resi1@@count-@resi2@@count-@patch@@count dipole: ?rdip
endif 
!! Check molecular polarizability
!VIBRAN
!diag dscf fini step 0.001
!END

shake off
drude reset
lone clear
delete atom sele all end

incr count
if count le @nres goto loop_carb1
